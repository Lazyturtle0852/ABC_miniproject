# 初心者向け開発マニュアル

## 🚀 クイックスタート（5分で始める）

経験者の方は、まずこちらから始めてください！

### 前提条件

- Python 3.10以上がインストールされていること
- ターミナル（コマンドプロンプト）が使えること

### セットアップ手順（2ステップ）

#### ステップ1: プロジェクトの取得

```bash
# Gitを使用する場合
git clone <repository_url>
cd ABC_miniproject

# または、既にプロジェクトフォルダがある場合
cd /path/to/ABC_miniproject
```

#### ステップ2: セットアップスクリプトを実行

```bash
# 実行権限を付与（初回のみ）
chmod +x setup.sh

# セットアップスクリプトを実行
./setup.sh
```

**セットアップスクリプトが自動的に行うこと：**
- ✅ Pythonのバージョンチェック（3.10以上）
- ✅ 仮想環境の作成
- ✅ 依存パッケージのインストール
- ✅ .envファイルの作成

> ⏱️ 初回インストールには5〜10分かかる場合があります。気長に待ちましょう。

#### ステップ3: 環境変数を設定

セットアップスクリプトが`.env`ファイルを作成しているので、それを開いてOpenAI APIキーを設定してください：

```bash
# テキストエディタで.envファイルを開く
# macOSの場合
open -a TextEdit .env

# Linuxの場合
nano .env
# または
vim .env
```

`.env` ファイルに以下を設定：

```
OPENAI_API_KEY=sk-your-api-key-here
```

> 🔑 APIキーの取得方法: [OpenAI Platform](https://platform.openai.com/api-keys)

> **💡 ヒント**: セットアップスクリプトは`.env.example`から`.env`を自動的に作成します。既に`.env`ファイルがある場合は、そのまま使用できます。

### アプリを起動

```bash
# 仮想環境が有効化されていることを確認（プロンプトに (venv) が表示されている）
streamlit run app.py
```

ブラウザで `http://localhost:8501` にアクセス！

> **💡 トラブルが発生したら**: 下記の「詳細マニュアル」を参照してください。

---

## 📚 目次

1. [はじめに](#はじめに)
2. [必要なソフトウェア](#必要なソフトウェア)
3. [環境構築の手順](#環境構築の手順)
4. [プロジェクトの起動方法](#プロジェクトの起動方法)
5. [基本的な使い方](#基本的な使い方)
6. [トラブルシューティング](#トラブルシューティング)
7. [よくある質問（FAQ）](#よくある質問faq)

---

## はじめに

このマニュアルは、プログラミング初心者の方でもこのプロジェクトを始められるように作成されています。  
わからないことがあれば、遠慮なく質問してください！

### このプロジェクトについて

**AI対話振り返りメディテーションシステム**は、カメラとマイクを使ってあなたの感情を分析し、AIと対話できるアプリケーションです。

- 📹 カメラで表情を認識
- 🎤 マイクで音声を録音
- 🤖 AIがあなたの感情を理解して応答

---

## 必要なソフトウェア

開発を始める前に、以下のソフトウェアが必要です。

### 1. Python（必須）

**Python 3.10以上**が必要です。

#### インストール確認方法

ターミナル（コマンドプロンプト）を開いて、以下のコマンドを実行してください：

```bash
python3 --version
```

または

```bash
python --version
```

**結果の例：**
```
Python 3.10.11
```

もし「command not found」と表示されたら、Pythonをインストールする必要があります。

#### Pythonのインストール方法

- **macOS**: [Python公式サイト](https://www.python.org/downloads/)からダウンロード
- **Windows**: [Python公式サイト](https://www.python.org/downloads/)からダウンロード（インストール時に「Add Python to PATH」にチェックを入れる）
- **Linux**: パッケージマネージャーでインストール（例：`sudo apt install python3`）

### 2. Git（推奨）

コードのバージョン管理に使用します。必須ではありませんが、推奨します。

#### インストール確認方法

```bash
git --version
```

#### インストール方法

- **macOS**: Xcode Command Line Toolsをインストール（`xcode-select --install`）
- **Windows**: [Git公式サイト](https://git-scm.com/download/win)からダウンロード
- **Linux**: `sudo apt install git`

### 3. テキストエディタ（推奨）

コードを編集するために使用します。以下のいずれかがおすすめです：

- **Visual Studio Code**（無料・おすすめ）: [VS Code公式サイト](https://code.visualstudio.com/)
- **PyCharm Community Edition**（無料）: [PyCharm公式サイト](https://www.jetbrains.com/pycharm/)
- **Sublime Text**（有料・無料試用可）: [Sublime Text公式サイト](https://www.sublimetext.com/)

---

## 環境構築の手順

このセクションでは、セットアップスクリプト（`setup.sh`）を使用した環境構築手順を説明します。

### ステップ1: プロジェクトの取得

#### Gitを使用する場合

```bash
git clone <repository_url>
cd ABC_miniproject
```

> **💡 ヒント**: `<repository_url>` を実際のリポジトリURLに置き換えてください。

#### 既にプロジェクトフォルダがある場合

ターミナル（コマンドプロンプト）を開いて、プロジェクトフォルダに移動します。

```bash
cd /path/to/ABC_miniproject
```

> **💡 ヒント**: フォルダをドラッグ&ドロップしてターミナルに入力すると、パスが自動入力されます。

### ステップ2: セットアップスクリプトを実行

セットアップスクリプト（`setup.sh`）を実行すると、以下の処理が自動的に行われます：

1. **Pythonのバージョンチェック**: Python 3.10以上がインストールされているか確認
2. **必要なファイルの確認**: `requirements.txt`や`.env.example`の存在確認
3. **仮想環境の作成**: プロジェクト専用のPython環境を作成
4. **パッケージのインストール**: 必要なパッケージを自動インストール
5. **環境変数ファイルの作成**: `.env`ファイルを自動作成

#### 実行方法

```bash
# 実行権限を付与（初回のみ）
chmod +x setup.sh

# セットアップスクリプトを実行
./setup.sh
```

#### 実行結果の例

```
🚀 AI対話振り返りメディテーションシステム セットアップ開始

🔍 Pythonのバージョンを確認中...
✅ Python 3.10.11 を検出しました

📋 必要なファイルを確認中...
✅ requirements.txt を確認しました
✅ .env.example を確認しました

📦 仮想環境をセットアップ中...
   仮想環境を作成中...
✅ 仮想環境を作成しました

🔧 仮想環境を有効化中...

⬆️  pipをアップグレード中...
✅ pipをアップグレードしました

📥 依存パッケージをインストール中...
   （初回インストールには5〜10分かかる場合があります）
✅ 依存パッケージのインストールが完了しました

🔍 インストールを確認中...
✅ 主要パッケージのインストールを確認しました

📝 環境変数ファイルをセットアップ中...
✅ .envファイルを作成しました
⚠️  .envファイルにOpenAI APIキーを設定してください

════════════════════════════════════════
✅ セットアップが完了しました！
════════════════════════════════════════
```

> **⏱️ 時間**: 初回インストールには5〜10分かかる場合があります。気長に待ちましょう。

### ステップ3: 環境変数の設定

セットアップスクリプトが`.env`ファイルを作成しているので、それを開いてOpenAI APIキーを設定してください。

#### .envファイルを開く

```bash
# macOSの場合
open -a TextEdit .env

# Linuxの場合
nano .env
# または
vim .env
```

#### APIキーを設定

`.env` ファイルに以下を設定：

```
OPENAI_API_KEY=sk-your-actual-api-key-here
```

> **🔑 OpenAI APIキーの取得方法：**
> 1. [OpenAI Platform](https://platform.openai.com/)にアクセス
> 2. アカウントを作成（またはログイン）
> 3. 「API keys」ページに移動
> 4. 「Create new secret key」をクリック
> 5. 表示されたキーをコピーして `.env` ファイルに貼り付け
>
> **⚠️ 重要**: APIキーは他人に見せないでください！

### セットアップスクリプトでエラーが出た場合

セットアップスクリプトでエラーが出た場合は、以下のトラブルシューティングセクションを参照してください。

---

## プロジェクトの起動方法

### 1. 仮想環境を有効化（まだの場合）

```bash
# macOS / Linux
source venv/bin/activate

# Windows
venv\Scripts\activate
```

### 2. Streamlitアプリを起動

```bash
streamlit run app.py
```

**実行結果の例：**
```
  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8501
  Network URL: http://192.168.1.xxx:8501
```

### 3. ブラウザでアクセス

自動的にブラウザが開きます。開かない場合は、表示されたURL（通常は `http://localhost:8501`）をブラウザのアドレスバーに入力してください。

### 4. アプリの停止

アプリを停止するには、ターミナルで `Ctrl + C` を押します。

---

## 基本的な使い方

### アプリの画面構成

1. **📹 カメラ映像エリア（左側）**
   - Webカメラの映像が表示されます
   - 感情がリアルタイムで表示されます

2. **🎤 音声入力エリア（右側）**
   - 「録音を開始してください」ボタンをクリック
   - 話したい内容を話します
   - 録音を停止すると自動的に処理が始まります

3. **サイドバー（左側）**
   - ユーザー選択
   - 過去の感情グラフ

4. **💬 対話履歴（下部）**
   - これまでの対話が表示されます

### 使い方の流れ

1. **カメラの許可**
   - ブラウザでカメラへのアクセスを許可してください
   - 「許可」をクリック

2. **ユーザー選択**
   - サイドバーで「User A」「User B」「User C」から選択

3. **録音開始**
   - 「録音を開始してください」ボタンをクリック
   - マイクへのアクセスを許可

4. **話す**
   - カメラを見ながら、その日の出来事や気持ちを話してください
   - 例：「今日は仕事で大変だったけど、達成感もあった」

5. **録音停止**
   - 話し終わったら録音を停止
   - 自動的に音声認識とAI応答が生成されます

6. **対話を続ける**
   - AIの応答を読んで、必要に応じてさらに話してください

---

## トラブルシューティング

### 問題1: 「command not found: python3」と表示される

**原因**: Pythonがインストールされていない、またはパスが通っていない

**解決方法**:
1. Pythonがインストールされているか確認
2. Windowsの場合、インストール時に「Add Python to PATH」にチェックが入っていたか確認
3. ターミナルを再起動してみる

### 問題2: 「No module named 'streamlit'」や「No module named 'librosa'」と表示される

**原因**: 仮想環境が有効化されていない、またはパッケージがインストールされていない

**解決方法**:

1. **仮想環境が有効化されているか確認**
   - ターミナルのプロンプトに `(venv)` が表示されているか確認してください
   - 表示されていない場合は、以下のコマンドで有効化：
     ```bash
     # macOS / Linux
     source venv/bin/activate
     
     # Windows
     venv\Scripts\activate
     ```

2. **パッケージを再インストール**
   ```bash
   pip install -r requirements.txt
   ```

3. **仮想環境内でstreamlitを実行**
   - 仮想環境が有効化されている状態で `streamlit run app.py` を実行してください
   - プロンプトに `(venv)` が表示されていることを確認してから実行

### 問題4: カメラが表示されない

**原因**: ブラウザでカメラへのアクセスが許可されていない

**解決方法**:
1. ブラウザの設定でカメラへのアクセスを許可
2. Chromeの場合：設定 → プライバシーとセキュリティ → サイトの設定 → カメラ
3. ブラウザを再起動

### 問題5: 音声認識が失敗する

**原因**: OpenAI APIキーが設定されていない、または無効

**解決方法**:
1. `.env` ファイルに正しいAPIキーが設定されているか確認
2. APIキーに `sk-` で始まる正しいキーが入っているか確認
3. OpenAIのアカウントにクレジットが残っているか確認

### 問題6: 「ModuleNotFoundError」が表示される

**原因**: 必要なパッケージがインストールされていない

**解決方法**:
```bash
# セットアップスクリプトを再実行（推奨）
./setup.sh

# または、手動で再インストール
source venv/bin/activate
pip install -r requirements.txt
```

### 問題7: 仮想環境を有効化できない（Windows）

**原因**: 実行ポリシーの制限

**解決方法**:
1. PowerShellを管理者として開く
2. 以下のコマンドを実行：
   ```powershell
   Set-ExecutionPolicy RemoteSigned -Scope CurrentUser
   ```
3. 再度仮想環境を有効化

### 問題8: DeepFaceのモデルダウンロードが遅い

**原因**: 初回起動時にモデルファイルをダウンロードするため

**解決方法**:
- これは正常な動作です。初回のみ時間がかかります（5〜10分程度）
- インターネット接続を確認してください

---

## よくある質問（FAQ）

### Q1: 仮想環境って何ですか？

**A**: 仮想環境は、このプロジェクト専用のPython環境です。  
他のプロジェクトとパッケージのバージョンが競合しないようにするために使用します。

### Q2: 仮想環境を有効化するのを忘れました

**A**: ターミナルで `source venv/bin/activate`（macOS/Linux）または `venv\Scripts\activate`（Windows）を実行してください。

### Q3: ターミナルを閉じたらどうなりますか？

**A**: 仮想環境が無効化されます。次回起動時は再度有効化が必要です。

### Q4: OpenAI APIキーは無料ですか？

**A**: 無料トライアルがありますが、使用量に応じて課金されます。  
詳細は[OpenAIの料金ページ](https://openai.com/pricing)を確認してください。

### Q5: 他の人とAPIキーを共有してもいいですか？

**A**: **絶対にダメです！** APIキーは個人情報です。他人に見せたり、GitHubにアップロードしたりしないでください。

### Q6: エラーが出たときはどうすればいいですか？

**A**: 
1. エラーメッセージをよく読む
2. このマニュアルの「トラブルシューティング」を確認
3. それでも解決しない場合は、エラーメッセージをコピーしてチームメンバーに相談

### Q7: コードを編集するにはどうすればいいですか？

**A**: 
1. Visual Studio Codeなどのテキストエディタで `.py` ファイルを開く
2. コードを編集
3. 保存（`Cmd + S` / `Ctrl + S`）
4. Streamlitアプリが自動的にリロードされます

### Q8: データベースファイルはどこに保存されますか？

**A**: プロジェクトフォルダ内に `conversation_logs.db` というファイルが作成されます。

### Q9: プロジェクトを削除したい場合は？

**A**: 
1. Streamlitアプリを停止（`Ctrl + C`）
2. 仮想環境を無効化（`deactivate`）
3. プロジェクトフォルダを削除

### Q10: パッケージを追加したい場合は？

**A**: 
1. `requirements.txt` にパッケージ名を追加
2. `pip install パッケージ名` でインストール
3. `pip freeze > requirements.txt` で更新（推奨）

---

## 次のステップ

環境構築が完了したら、以下のステップに進みましょう：

1. ✅ アプリが起動した
2. 📖 [README.md](README.md) を読んでプロジェクトの全体像を理解
3. 📝 [instruction.md](instruction.md) を読んで仕様を確認
4. 💻 コードを読んで理解を深める
5. 🚀 機能を追加・改善する

---

## サポート

わからないことがあれば、遠慮なく質問してください！

- チームメンバーに相談
- エラーメッセージを共有
- このマニュアルを参照

**Happy Coding! 🎉**

